// egnyte-sdk v0.1.1 (2014-06-09) 
// license:MIT 
// ztenerowicz@egnyte.com 
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],2:[function(a,b){(function(a){!function(b){function c(a){return"function"==typeof a}function d(a){return"object"==typeof a}function e(b){"undefined"!=typeof setImmediate?setImmediate(b):"undefined"!=typeof a&&a.nextTick?a.nextTick(b):setTimeout(b,0)}var f;b[0][b[1]]=function g(){var a,b=[],h=[],i=function(c,d){return null==a&&null!=c&&(a=c,b=d,h.length&&e(function(){for(var a=0;a<h.length;a++)h[a]()})),a};return i.then=function(i,j){var k=g(),l=function(){function e(a){var b,g=0;try{if(a&&(d(a)||c(a))&&c(b=a.then)){if(a===k)throw new TypeError;b.call(a,function(){g++||e.apply(f,arguments)},function(a){g++||k(!1,[a])})}else k(!0,arguments)}catch(h){g++||k(!1,[h])}}try{var g=a?i:j;c(g)?e(g.apply(f,b||[])):k(a,b)}catch(h){k(!1,[h])}};return null!=a?e(l):h.push(l),k},i.always=function(a){return i.then(a,a)},i.error=function(a){return i.then(0,a)},i}}("undefined"==typeof b?[window,"pinkySwear"]:[b,"exports"])}).call(this,a("FWaASH"))},{FWaASH:1}],3:[function(a,b){var c,d="undefined"!=typeof window?window.navigator.userAgent:"",e=/OS X/.test(d),f=/Opera/.test(d),g=!/like Gecko/.test(d)&&!f,h=b.exports={0:e?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:e?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:e&&g?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:f?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(c=58;65>c;++c)h[c]=String.fromCharCode(c);for(c=48;58>c;++c)h[c]=c-48+"";for(c=65;91>c;++c)h[c]=String.fromCharCode(c);for(c=96;106>c;++c)h[c]="<num-"+(c-96)+">";for(c=112;136>c;++c)h[c]="F"+(c-111)},{}],4:[function(a,b){function c(a,b){function c(){4===k.readyState&&e()}function e(){var a=null,c=k.statusCode=k.status,d=k.body=k.response||k.responseText||k.responseXML;if(1223===c&&(c=204),0===c||c>=400&&600>c){var e;try{e=k.responseText}catch(f){}e=e||g[String(k.status).charAt(0)],a=new Error(e),a.statusCode=k.status}if(r)try{d=k.body=JSON.parse(d)}catch(f){}b(a,k,d)}function j(a){b(a,k)}"string"==typeof a&&(a={uri:a}),a=a||{},b=f(b);var k=a.xhr||null;!k&&a.cors?k=new i:k||(k=new h);var l,m=k.url=a.uri||a.url,n=k.method=a.method||"GET",o=a.body||a.data,p=k.headers=a.headers||{},q=!!a.sync,r=!1;if("json"in a&&(r=!0,"GET"!==n&&"HEAD"!==n&&(p["Content-Type"]="application/json",o=JSON.stringify(a.json))),k.onreadystatechange=c,k.onload=e,k.onerror=j,k.onprogress=function(){},k.ontimeout=d,k.open(n,m,!q),a.cors&&(k.withCredentials=!0),q||(k.timeout="timeout"in a?a.timeout:5e3),k.setRequestHeader)for(l in p)p.hasOwnProperty(l)&&k.setRequestHeader(l,p[l]);return"responseType"in a&&(k.responseType=a.responseType),k.send(o),k}function d(){}var e=a("global/window"),f=a("once"),g={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},h=e.XMLHttpRequest||d,i="withCredentials"in new h?e.XMLHttpRequest:e.XDomainRequest;b.exports=c},{"global/window":5,once:6}],5:[function(a,b){(function(a){b.exports="undefined"!=typeof window?window:"undefined"!=typeof a?a:{}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(a,b){function c(a){var b=!1;return function(){return b?void 0:(b=!0,a.apply(this,arguments))}}b.exports=c,c.proto=c(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return c(this)},configurable:!0})})},{}],7:[function(a){!function(){"use strict";function b(b,e){d=c.extend(d,e),d.egnyteDomainURL=c.normalizeURL(b);var f=a("./lib/api")(d);return{domain:d.egnyteDomainURL,filePicker:a("./lib/filepicker/byapi")(f),filePickerRemote:a("./lib/filepicker/bysession")(d),API:f}}var c=a("./lib/reusables/helpers"),d={};window.Egnyte={init:b}}()},{"./lib/api":8,"./lib/filepicker/byapi":12,"./lib/filepicker/bysession":13,"./lib/reusables/helpers":20}],8:[function(a,b){var c=a("./api_elements/main"),d=a("./api_elements/storage"),e=a("./api_elements/link");b.exports=function(a){var b=c(a),f=d(b,a),g=e(b,a);return{auth:b,storage:f,link:g}}},{"./api_elements/link":9,"./api_elements/main":10,"./api_elements/storage":11}],9:[function(a,b){function c(a){var b={path:null,type:"file",accessibility:"domain"};return i.start(!0).then(function(){if(a=j.extend(b,a),a.path=j.encodeNameSafe(a.path),!a.path)throw new Error("Path attribute missing or incorrect");return g.promiseRequest({method:"POST",url:g.getEndpoint()+k,json:a})}).then(function(a){return a.body})}function d(a){return g.promiseRequest({method:"DELETE",url:g.getEndpoint()+k+"/"+a}).then(function(a){return a.response.statusCode})}function e(a){return g.promiseRequest({method:"GET",url:g.getEndpoint()+k+"/"+a}).then(function(a){return a.body})}function f(a){return i.start(!0).then(function(){return a.path=a.path&&j.encodeNameSafe(a.path),g.promiseRequest({method:"get",url:g.getEndpoint()+k,params:a})}).then(function(a){return a.body})}var g,h,i=a("../promises"),j=a("../reusables/helpers"),k="/links";b.exports=function(a,b){return h=b,g=a,{createLink:c,removeLink:d,listLink:e,listLinks:f}}},{"../promises":18,"../reusables/helpers":20}],10:[function(a,b){function c(a){if(n)a();else{var b=p.exec(window.location.hash);b?b.length>1&&(n=b[1],a()):window.location.href=o.egnyteDomainURL+"/puboauth/token?client_id="+o.key+"&mobile="+~~o.mobile+"&redirect_uri="+window.location.href}}function d(a){a.setRequestHeader("Authorization","Bearer "+n)}function e(){return{Authorization:"Bearer "+n}}function f(){return o.egnyteDomainURL+"/pubapi/v1"}function g(){return!!n}function h(){return n}function i(a){n=a}function j(){n=null}function k(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function l(a,b){return g()?(a.params&&(a.url+="?"+k(a.params)),a.headers=a.headers||{},a.headers.Authorization="Bearer "+h(),r(a,function(a,c,d){try{d=JSON.parse(d)}catch(e){}b.call(this,a,c,d)})):void b.call(this,new Error("Not authorized"),{statusCode:0},null)}function m(a){var b=q.defer();try{l(a,function(a,c,d){a?b.reject({error:a,response:c,body:d}):b.resolve({response:c,body:d})})}catch(c){b.reject({error:c})}return b.promise}var n,o,p=/access_token=([^&]+)/,q=a("../promises"),r=a("xhr");b.exports=function(a){return o=a,o.token&&i(o.token),{isAuthorized:g,setToken:i,requestToken:c,authorizeXHR:d,getHeaders:e,getToken:h,dropToken:j,getEndpoint:f,sendRequest:l,promiseRequest:m}}},{"../promises":18,xhr:4}],11:[function(a,b){function c(a){return n.start(!0).then(function(){return a=o.encodeNameSafe(a),l.promiseRequest({method:"GET",url:l.getEndpoint()+p+encodeURI(a)})}).then(function(a){return 200==a.response.statusCode?!0:!1},function(a){if(404==a.response.statusCode)return!1;throw a.error})}function d(a){return n.start(!0).then(function(){return a=o.encodeNameSafe(a),l.promiseRequest({method:"GET",url:l.getEndpoint()+p+encodeURI(a)})}).then(function(a){return a.body})}function e(a,b){return n.start(!0).then(function(){a=o.encodeNameSafe(a);var c={method:"GET",url:l.getEndpoint()+q+encodeURI(a)};return b&&(c.responseType="arraybuffer"),l.promiseRequest(c)}).then(function(a){return a.response})}function f(a){return n.start(!0).then(function(){return a=o.encodeNameSafe(a),l.promiseRequest({method:"POST",url:l.getEndpoint()+p+encodeURI(a),json:{action:"add_folder"}})}).then(function(b){return 201==b.response.statusCode?{path:a}:void 0})}function g(a,b){return n.start(!0).then(function(){if(!b)throw new Error("Cannot move to empty path");return a=o.encodeNameSafe(a),b=o.encodeNameSafe(b),l.promiseRequest({method:"POST",url:l.getEndpoint()+p+encodeURI(a),json:{action:"move",destination:"/"+b}})}).then(function(c){return 200==c.response.statusCode?{oldPath:a,path:b}:void 0})}function h(a,b){return n.start(!0).then(function(){if(!window.FormData)throw new Error("Unsupported browser");var c=b,d=new window.FormData;return d.append("file",c),a=o.encodeNameSafe(a)||"",l.promiseRequest({method:"POST",url:l.getEndpoint()+q+encodeURI(a),body:d})}).then(function(b){if(200===b.response.statusCode||201===b.response.statusCode)return{id:b.response.getResponseHeader("etag"),path:a};throw new Error(b.response.statusCode)})}function i(a,b){return n.start(!0).then(function(){a=o.encodeNameSafe(a)||"";var c={method:"DELETE",url:l.getEndpoint()+p+encodeURI(a)};return b&&(c.params={entry_id:b}),l.promiseRequest(c)}).then(function(a){return a.response.statusCode})}function j(a,b){return n.start(!0).then(function(){if(!b)throw new Error("Version ID (second argument) is missing");return i(a,b)})}function k(a){return i(a)}var l,m,n=a("../promises"),o=a("../reusables/helpers"),p="/fs",q="/fs-content";b.exports=function(a,b){return m=b,l=a,{exists:c,get:d,download:e,createFolder:f,move:g,rename:g,remove:k,storeFile:h,removeFileVersion:j}}},{"../promises":18,"../reusables/helpers":20}],12:[function(a,b){!function(){function c(a){var b;return b=function(b,c){if(!c)throw new Error("Setup required as a second argument");var g,h,i,j={folder:!0,file:!0,multiple:!0},k=d.extend(j,c.select);return g=function(){h.destroy(),h=null,i=null},i=new f(a,{select:k}),h=new e({el:b,model:i,barAlign:c.barAlign,handlers:{ready:c.ready,selection:function(a){c.selection&&c.selection(a),g()},close:function(){c.cancel&&c.cancel(),g()},error:c.error}},c.texts),i.fetch(c.path||"/"),{close:g}}}var d=a("../reusables/helpers"),e=(a("../reusables/dom"),a("../filepicker_elements/view")),f=a("../filepicker_elements/model");b.exports=c}()},{"../filepicker_elements/model":15,"../filepicker_elements/view":16,"../reusables/dom":19,"../reusables/helpers":20}],13:[function(a,b){!function(){function c(a,b){a.handler=i.createMessageHandler(a.sourceOrigin,a.marker,b),a._evListener=h.addListener(window,"message",a.handler)}function d(a,b){a._evListener.destroy(),b.parentNode&&b.parentNode.removeChild(b)}function e(a,b){return function(c){var d;if(c.action)switch(b.hasOwnProperty(c.action)&&b[c.action]&&b[c.action].call&&(d=b[c.action](c.data)),c.action){case"selection":d!==!1&&a();break;case"cancel":a()}}}function f(a){var b,f=!1;return a=g.extend(j,a),b=function(b,j){if(!j)throw new Error("Setup required as a second argument");var k,l={marker:a.channelMarker,sourceOrigin:a.egnyteDomainURL},m=function(){j.path&&i.sendMessage(k.contentWindow,l,"openAt",j.path)},n=function(){d(l,k)};return k=h.createFrame(a.egnyteDomainURL+"/"+a.filepickerViewAddress),c(l,e(n,{selection:j.selection||g.noop,cancel:j.cancel||g.noop,ready:function(){f=!0,m(),j.ready||j.ready()}})),b.appendChild(k),{close:n}}}var g=a("../reusables/helpers"),h=a("../reusables/dom"),i=a("../reusables/messages"),j={filepickerViewAddress:"folderExplorer.html",channelMarker:"'E"};b.exports=f}()},{"../reusables/dom":19,"../reusables/helpers":20,"../reusables/messages":21}],14:[function(a,b){function c(a){return f.test(a)?a.replace(f,"$1"):""}var d=a("../reusables/helpers"),e={};d.each({audio:["mp3","wav","wma","aiff","mid","midi","mp2"],video:["wmv","avi","mpg","mpeg","mp4","webm","ogv","flv","mov"],pdf:["pdf"],word_processing:["doc","dot","docx","dotx","docm","dotm","odt ","ott","oth","odm","sxw","stw","sxg","sdw","sgl","rtf","hwp","uot","wpd","wps","gdoc"],spreadsheet:["123","xls","xlt","xla","xlsx","xltx","xlsm","xltm","xlam","xlsb","ods","fods","ots","sxc","stc","sdc","csv","uos","gsheet"],presentation:["ppt","pot","pps","ppa","pptx","potx","ppsx","ppam","pptm","potm","ppsm","odp","fodp","otp","sxi","sti","sdd","sdp","gslides"],cad:["dwg","dwf","dxf","sldprt","sldasm","slddrw"],text:["txt","log"],image:["odg","otg","odi","sxd","std","sda","svm","jpg","jpeg","png","gif","bmp","tif","tiff","psd","eps","tga","wmf","ai","cgm","fodg","jfif","pbm","pcd","pct","pcx","pgm","ppm","ras","sgf","svg","gdraw"],code:["html","htm","sql","xml","java","cpp","c","perl","py","rb","php","js","css","applescript","as3","as","bash","shell","sh","cfm","cfml","cs","pas","dcu","diff","patch","ez","erl","groovy","gvy","gy","gsh","javafx","jfx","pl","pm","ps1","ruby","sass","scss","scala","vb","vbscript","xhtml","xslt"],archive:["zip","rar","tar","gz","7z","bz2","z","xz","ace","sit","sitx","tgz","apk"]},function(a,b){d.each(a,function(a){e[a]=b})});var f=/.*\.([a-z0-9]*)$/i;b.exports={getMime:function(a){return e[c(a)]||"unknown"},getExt:c}},{"../reusables/helpers":20}],15:[function(a,b){function c(a,b){this.data=a,this.data.is_folder?(this.ext="",this.mime="unknown"):(this.ext=f.getExt(a.name).substr(0,3),this.mime=f.getMime(a.name)),this.isSelectable=b.opts.select.folder&&a.is_folder||b.opts.select.file&&!a.is_folder,this.parent=b,this.isCurrent=!1}function d(a,b){this.opts=b,this.API=a,this.page=1,this.pageSize=200}var e=a("../reusables/helpers"),f=a("./exts");c.prototype.defaultAction=function(){this.data.is_folder?this.parent.fetch(this.data.path):this.toggleSelect()},c.prototype.toggleSelect=function(){this.isSelectable&&(this.parent.opts.select.multiple||this.parent.deselect(),this.selected=!this.selected,this.onchange(),this.parent.onchange())},d.prototype.onloading=e.noop,d.prototype.onupdate=e.noop,d.prototype.onerror=e.noop,d.prototype._set=function(a){var b=this;this.path=a.path,this.page=1,this.rawItems=[],e.each(a.folders,function(a){b.rawItems.push(a)}),this.opts.select.file&&e.each(a.files,function(a){b.rawItems.push(a)}),this.totalPages=~~(this.rawItems.length/this.pageSize)+1,this.isMultiselectable=this.opts.select.multiple,this._buildItems()},d.prototype._buildItems=function(){var a=this;if(this.currentItem=-1,this.items=[],this.hasPages=this.rawItems.length>this.pageSize,0===this.rawItems.length)this.isEmpty=!0;else{this.isEmpty=!1;var b=this.rawItems.slice((this.page-1)*this.pageSize,this.page*this.pageSize);e.each(b,function(b){a.items.push(new c(b,a))})}this.onupdate(),this.onchange()},d.prototype.fetch=function(a){var b=this;a&&(this.path=a),b.onloading(),b.API.storage.get(this.path).then(function(a){b._set(a)}).error(function(a){b.onerror(a.error||a)})},d.prototype.switchPage=function(a){var b=this.page+a;b<=this.totalPages&&b>0&&(this.page=b,this._buildItems())},d.prototype.goUp=function(){var a=this.path.replace(/\/[^\/]+\/?$/i,"")||"/";a!==this.path&&this.fetch(a)},d.prototype.getSelected=function(){var a=[];return e.each(this.items,function(b){b.selected&&a.push(b.data)}),a},d.prototype.deselect=function(){e.each(this.items,function(a){a.selected&&(a.selected=!1,a.onchange())})},d.prototype.setAllSelection=function(a){e.each(this.items,function(b){b.selected=a,b.onchange()}),this.onchange()},d.prototype.mvCurrent=function(a){this.currentItem+a<this.items.length&&this.currentItem+a>=0&&(this.items[this.currentItem]&&(this.items[this.currentItem].isCurrent=!1,this.items[this.currentItem].onchange()),this.currentItem+=a,this.items[this.currentItem].isCurrent=!0,this.items[this.currentItem].onchange())},d.prototype.getCurrent=function(){return this.items[this.currentItem]},b.exports=d},{"../reusables/helpers":20,"./exts":14}],16:[function(a,b){"use strict";function c(a,b){var c=this;this.uid=Math.random(),h=this.uid,this.el=a.el,this.els={},this.evs=[];var i=e.extend({up:"<up>",down:"<down>",select:"<space>",explore:"<right>",back:"<left>",confirm:"<enter>",close:"<escape>"},a.keys);this.txt=f(b),this.bottomBarClass="left"===a.barAlign?"":".eg-bar-right",this.handlers=e.extend({selection:e.noop,close:e.noop,error:function(a){c.defaultError(a)}},a.handlers),this.model=a.model,this.model.onloading=e.bindThis(c,c.loading),this.model.onupdate=function(){if(c.render(),c.handlers.ready){var a=c.handlers.ready;c.handlers.ready=null,setTimeout(a,0)}},this.model.onerror=e.bindThis(c,c.handlers.error),this.model.onchange=function(){c.model.getSelected().length>0?c.els.ok.removeAttribute("disabled"):c.els.ok.setAttribute("disabled","")},this.els.back=g([["span.eg-filepicker-back.eg-btn","<"]]).childNodes[0],this.els.close=g([["span.eg-filepicker-close.eg-btn",this.txt("Cancel")]]).childNodes[0],this.els.ok=g([["span.eg-filepicker-ok.eg-btn",this.txt("Ok")]]).childNodes[0],this.els.pgup=g([["span.eg-filepicker-pgup.eg-btn",">"]]).childNodes[0],this.els.pgdown=g([["span.eg-filepicker-pgup.eg-btn","<"]]).childNodes[0],this.els.crumb=g([["span.eg-filepicker-path"]]).childNodes[0],this.els.selectAll=g([["input[type=checkbox]",{title:this.txt("Select all")}]]).childNodes[0],this.handleClick(this.el,c.focused),this.handleClick(this.els.back,c.goUp),this.handleClick(this.els.close,c.handlers.close),this.handleClick(this.els.ok,c.confirmSelection),this.handleClick(this.els.crumb,c.crumbNav),this.handleClick(this.els.selectAll,function(a){c.model.setAllSelection(!!a.target.checked)}),this.handleClick(this.els.pgup,function(){c.model.switchPage(1)}),this.handleClick(this.els.pgdown,function(){c.model.switchPage(-1)});var j={};j[i.up]=e.bindThis(c,c.kbNav_up),j[i.down]=e.bindThis(c,c.kbNav_down),j[i.select]=e.bindThis(c,c.kbNav_select),j[i.explore]=e.bindThis(c,c.kbNav_explore),j[i.back]=e.bindThis(c.model,c.model.goUp),j[i.confirm]=e.bindThis(c,c.confirmSelection),j[i.close]=e.bindThis(c,c.handlers.close),document.activeElement.blur(),this.evs.push(d.onKeys(document,j,e.bindThis(c,c.hasFocus)))}var d=a("../reusables/dom"),e=a("../reusables/helpers"),f=a("../reusables/texts"),g=a("../../vendor/zenjungle");a("./view.less");var h="no";c.prototype.destroy=function(){e.each(this.evs,function(a){a.destroy()}),this.evs=null,this.el.innerHTML="",this.el=null,this.els=null,this.model=null,this.handlers=null},c.prototype.handleClick=function(a,b){this.evs.push(d.addListener(a,"click",e.bindThis(this,b)))},c.prototype.render=function(){var a=this;this.els.list=document.createElement("ul");var b=["div.eg-filepicker-bar"];this.model.isMultiselectable&&(this.els.selectAll.checked=!1,b.push(this.els.selectAll)),b.push(this.els.back),b.push(this.els.crumb);var c=g([["div.eg-filepicker",b,this.els.list,["div.eg-filepicker-bar"+this.bottomBarClass,this.els.ok,this.els.close,["div.eg-filepicker-pager"+(this.model.hasPages?"":".eg-not"),this.els.pgdown,["span",this.model.page+"/"+this.model.totalPages],this.els.pgup]]]]);this.el.innerHTML="",this.el.appendChild(c),this.breadcrumbify(this.model.path),this.model.isEmpty?this.empty():e.each(this.model.items,function(b){a.renderItem(b)})},c.prototype.renderItem=function(a){var b=g([["a.eg-filepicker-name",["span.eg-ico.eg-filepicker-"+(a.data.is_folder?"folder":"file.eg-mime-"+a.mime),{"data-ext":a.ext},["span",a.ext]],a.data.name]]).childNodes[0],c=g([["input[type=checkbox]"+(a.isSelectable?"":".eg-not")]]).childNodes[0];c.checked=a.selected;var e=g([["li.eg-filepicker-item",c,b]]).childNodes[0];d.addListener(b,"click",function(b){return b.stopPropagation&&b.stopPropagation(),a.defaultAction(),!1}),d.addListener(e,"click",function(){a.toggleSelect()}),a.onchange=function(){c.checked=a.selected,e.setAttribute("aria-selected",a.isCurrent),a.isCurrent&&e.scrollIntoView(!1)},this.els.list.appendChild(e)},c.prototype.breadcrumbify=function(a){var b=a.split("/"),c=[],d="";e.each(b,function(a,b){d+="/"+a,a?c.push(["a",{"data-path":d},a+"/"]):0===b&&c.push(["a",{"data-path":d},"/"])}),this.els.crumb.innerHTML="",this.els.crumb.appendChild(g([c]))},c.prototype.loading=function(){this.els.list&&(this.els.list.innerHTML="",this.els.list.appendChild(g([["div.eg-placeholder",["div.eg-spinner"],this.txt("Loading")]])))},c.prototype.defaultError=function(a){this.els.list?(this.els.list.innerHTML="",this.els.list.appendChild(g([["div.eg-placeholder",a.message]]))):this.handlers.close(a)},c.prototype.empty=function(){this.els.list&&(this.els.list.innerHTML="",this.els.list.appendChild(g([["div.eg-placeholder",["div.eg-filepicker-folder"],this.txt("This folder is empty")]])))},c.prototype.hasFocus=function(){return h===this.uid},c.prototype.focused=function(){h=this.uid},c.prototype.goUp=function(){this.model.goUp()},c.prototype.confirmSelection=function(){var a=this.model.getSelected();a&&a.length&&this.handlers.selection.call(this,this.model.getSelected())},c.prototype.crumbNav=function(a){var b=a.target.getAttribute("data-path");b&&this.model.fetch(b)},c.prototype.kbNav_up=function(){this.model.mvCurrent(-1)},c.prototype.kbNav_down=function(){this.model.mvCurrent(1)},c.prototype.kbNav_select=function(){this.model.getCurrent().toggleSelect()},c.prototype.kbNav_confirm=function(){this.model.getCurrent().toggleSelect()},c.prototype.kbNav_explore=function(){var a=this.model.getCurrent();a.data.is_folder&&a.defaultAction()},b.exports=c},{"../../vendor/zenjungle":23,"../reusables/dom":19,"../reusables/helpers":20,"../reusables/texts":22,"./view.less":17}],17:[function(){!function(){var a=document.getElementsByTagName("head")[0];style=document.createElement("style"),style.type="text/css";var b='.eg-btn{display:inline-block;line-height:20px;padding:4px 18px;text-align:center;margin-right:8px;background-color:#fafafa;border:1px solid #ccc;border-radius:2px;cursor:pointer}.eg-not{visibility:hidden}.eg-filepicker{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;height:100%;padding:40px 0;border:1px solid #dbdbdb;color:#5e5f60;font-family:sans-serif;font-size:13px;position:relative}.eg-filepicker *{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.eg-filepicker input{vertical-align:middle;margin:8px}.eg-filepicker ul{padding:0;margin:0;height:100%;overflow-y:scroll}.eg-filepicker-bar{outline:1px solid #dbdbdb;height:32px;padding:4px;background:#f1f1f1;overflow:hidden}.eg-filepicker-bar:nth-child(1){margin-top:-40px}.eg-bar-right>*,.eg-filepicker-pager{float:right}.eg-filepicker-pager>span{margin-right:8px}.eg-bar-right>.eg-filepicker-pager{float:left}.eg-filepicker-ok{background-color:#3191f2;border-color:#2b82d9;color:#fff}.eg-filepicker-ok[disabled]{opacity:.3}.eg-filepicker-back{padding:4px 10px;position:relative}.eg-filepicker-back::before{bottom:4px;right:12px;position:absolute;border:10px solid transparent;border-right:10px solid #5e5f60;content:""}.eg-filepicker-path{width:calc(100% - 88px);display:inline-block;overflow:auto;vertical-align:middle}.eg-filepicker-item{line-height:1.2em;list-style:none;padding:4px 0}.eg-filepicker-item:hover{background-color:#f1f5f8;outline:1px solid #dbdbdb}.eg-filepicker-item[aria-selected=true]{background-color:#dde9f3}.eg-filepicker-item *{vertical-align:middle;display:inline-block}.eg-filepicker a{cursor:pointer}.eg-filepicker a:hover{text-decoration:underline}@-webkit-keyframes egspin{to{transform:rotate(360deg)}}@keyframes egspin{to{transform:rotate(360deg)}}.eg-placeholder{margin:40%;margin:calc(50% - 42px);margin-bottom:0;text-align:center}.eg-placeholder>div{margin:0 auto}.eg-placeholder>.eg-spinner{content:"";-webkit-animation:egspin 1s infinite linear;animation:egspin 1s infinite linear;width:30px;height:30px;border:solid 7px;border-radius:50%;border-color:transparent transparent #dbdbdb}.eg-ico{margin-right:4px}.eg-ico.eg-mime-audio{background-color:#94cbff}.eg-ico.eg-mime-video{background-color:#8f6bd1}.eg-ico.eg-mime-pdf{background-color:#e64e40}.eg-ico.eg-mime-word_processing{background-color:#4ca0e6}.eg-ico.eg-mime-spreadsheet{background-color:#6bd17f}.eg-ico.eg-mime-presentation{background-color:#fa8639}.eg-ico.eg-mime-cad{background-color:#f2d725}.eg-ico.eg-mime-text{background-color:#9e9e9e}.eg-ico.eg-mime-image{background-color:#d16bd0}.eg-ico.eg-mime-code{background-color:#a5d16b}.eg-ico.eg-mime-archive{background-color:#d19b6b}.eg-filepicker-file{width:40px;height:40px;background:#dbdbdb;text-align:right}.eg-filepicker-file>span{text-align:center;font-size:14.28571429px;line-height:20px;font-weight:300;margin:10px 0;height:20px;width:32px;background:rgba(0,0,0,.15);color:#fff;cursor:default}.eg-filepicker-folder{background-color:#e1e1ba;border:#d4d8bd .1em solid;border-radius:.1em;border-top-left-radius:0;font-size:10px;margin-top:.75em;height:2.8em;overflow:visible;width:4em;position:relative}.eg-filepicker-folder:before{display:block;position:absolute;top:-.5em;left:-.1em;border:#d1dabc .1em solid;border-radius:.2em;border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0;background-color:#dfe4b9;content:" ";width:60%;height:.5em}.eg-filepicker-folder:after{display:block;position:absolute;top:.3em;height:2.4em;left:0;width:100%;border-top-left-radius:.3em;border-top-right-radius:.3em;background-color:#f3f7d3;content:" "}.eg-filepicker-folder>span{display:none}';style.styleSheet?style.styleSheet.cssText=b:style.appendChild(document.createTextNode(b)),a.appendChild(style)}()},{}],18:[function(a,b){var c=a("pinkyswear");b.exports={defer:function(){var a=c();return{promise:a,resolve:function(b){a(!0,[b])},reject:function(b){a(!1,[b])}}},start:function(a){var b=c();return b(a),b}}},{pinkyswear:2}],19:[function(a,b){function c(a,b,c){var e;return a.addEventListener?(e=c,a.addEventListener(b,c,!1)):(e=function(a){a=a||window.event,a.target||(a.target=a.srcElement);var b=c.call(this,a);return b===!1&&(a.cancelBubble=!0),b},a.attachEvent("on"+b,e)),{destroy:function(){d(a,b,e)}}}function d(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent(b,c)}var e=a("vkey");b.exports={addListener:c,onKeys:function(a,b,d){return c(a,"keyup",function(a){return a.preventDefault&&a.preventDefault(),d()&&b[e[a.keyCode]]&&b[e[a.keyCode]](),!1})},createFrame:function(a){var b=document.createElement("iframe");return b.setAttribute("scrolling","no"),b.style.width="100%",b.style.height="100%",b.style.minWidth="400px",b.style.minHeight="400px",b.style.border="1px solid #dbdbdb",b.src=a,b}}},{vkey:3}],20:[function(a,b){function c(a,b){if(a)if(a.length===+a.length)for(var c=0;c<a.length;c++)b.call(null,a[c],c,a);else for(var c in a)a.hasOwnProperty(c)&&b.call(null,a[c],c,a)}b.exports={extend:function(a){var b,c;for(b=1;b<arguments.length;b++)if(arguments[b])for(c in arguments[b])arguments[b].hasOwnProperty(c)&&"undefined"!=typeof arguments[b][c]&&(a[c]=arguments[b][c]);return a},noop:function(){},bindThis:function(a,b){return function(){return b.apply(a,arguments)}},each:c,normalizeURL:function(a){return a.replace(/\/*$/,"")},encodeNameSafe:function(a){if(!a)throw new Error("No name given");var b=[];return c(a.split("/"),function(a){b.push(a.replace(/[?*&#%<>]*/gi,""))}),b=b.join("/").replace(/^\/\//,"/")}}},{}],21:[function(a,b){function c(a,b,c){return function(d){if(!a||e.normalizeURL(d.origin)===e.normalizeURL(a)){var f=d.data;if(f.substr(0,2)===b){try{f=JSON.parse(f.substring(2))}catch(g){}f&&c(f)}}}}function d(a,b,c,d){var e="*";if("string"!=typeof d||"string"!=typeof c)throw new TypeError("only string is acceptable as action and data");try{e=a.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}catch(f){}d=d.replace(/"/gm,'\\"').replace(/(\r\n|\n|\r)/gm,""),a.postMessage(b.marker+'{"action":"'+c+'","data":"'+d+'"}',e)}var e=a("../reusables/helpers");b.exports={sendMessage:d,createMessageHandler:c}},{"../reusables/helpers":20}],22:[function(a,b){b.exports=function(a){return function(b){if(a){if(a[b])return a[b];if(a[b.toLowerCase()])return a[b.toLowerCase()]}return b}}},{}],23:[function(a,b){var c=function(){var a=function(a){return!!a&&"[object Object]"==Object.prototype.toString.call(a)&&!a.nodeType},b=function(a){return"[object Array]"==Object.prototype.toString.call(a)},c=function(a,b){var c;if(a)if(a.length)for(c=0;c<a.length;c++)b(a[c],c);else for(c in a)a.hasOwnProperty(c)&&b(a[c],c)},d=function(){var a={};return c(arguments,function(b){c(b,function(b,c){a[c]=b})}),a},e=function(a){var b={"\\[([a-z\\-]+)=([^\\]]+)\\]":function(a){var b={};return b[a[1]]=a[2].replace(/^["']/,"").replace(/["']$/,""),b},"#([a-zA-Z][a-zA-Z0-9\\-_]*)":function(a){return{id:a[1]}},"(\\.[a-zA-Z][a-zA-Z0-9\\-_]*)+":function(a){return{"class":a[0].substr(1).split(".").join(" ")}}},e={};return c(b,function(b,c){var f;for(c=new RegExp(c);c.test(a);)f=c.exec(a),a=a.replace(f[0],""),e=d(e,b(f))}),[a,e]},f=function(g,h){return h=h||document.createDocumentFragment(),c(g,function(g){var i,j,k;b(g)?"string"==typeof g[0]?(i=e(g.shift()),j=a(g[0])?g.shift():{},k=document.createElement(i[0]),c(d(i[1],j),function(a,b){k.setAttribute(b,a)}),h.appendChild(k),f(g,k)):f(g,h):g.nodeType?h.appendChild(g):("string"==typeof g||"number"==typeof g)&&h.appendChild(document.createTextNode(g))}),h};return f}();"undefined"!=typeof b&&(b.exports=c)},{}]},{},[7]);