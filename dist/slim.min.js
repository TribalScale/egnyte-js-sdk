// egnyte-js-sdk v1.0.0 (2014-07-21) 
// license:Apache2 
// ztenerowicz@egnyte.com 
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){!function(a){function b(a){return"function"==typeof a}function c(a){return"object"==typeof a}function d(a){"undefined"!=typeof process&&process.nextTick?process.nextTick(a):setTimeout(a,0)}var e;a[0][a[1]]=function f(){var a,g=[],h=[],i=function(b,c){return null==a&&null!=b&&(a=b,g=c,h.length&&d(function(){for(var a=0;a<h.length;a++)h[a]()})),a};return i.then=function(i,j){var k=f(),l=function(){function d(a){var f,g=0;try{if(a&&(c(a)||b(a))&&b(f=a.then)){if(a===k)throw new TypeError;f.call(a,function(){g++||d.apply(e,arguments)},function(a){g++||k(!1,[a])})}else k(!0,arguments)}catch(h){g++||k(!1,[h])}}try{var f=a?i:j;b(f)?d(f.apply(e,g||[])):k(a,g)}catch(h){k(!1,[h])}};return null!=a?d(l):h.push(l),k},i.always=function(a){return i.then(a,a)},i.error=function(a){return i.then(0,a)},i}}("undefined"==typeof b?[window,"pinkySwear"]:[b,"exports"])},{}],2:[function(a,b){var c,d="undefined"!=typeof window?window.navigator.userAgent:"",e=/OS X/.test(d),f=/Opera/.test(d),g=!/like Gecko/.test(d)&&!f,h=b.exports={0:e?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:e?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:e&&g?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:f?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(c=58;65>c;++c)h[c]=String.fromCharCode(c);for(c=48;58>c;++c)h[c]=c-48+"";for(c=65;91>c;++c)h[c]=String.fromCharCode(c);for(c=96;106>c;++c)h[c]="<num-"+(c-96)+">";for(c=112;136>c;++c)h[c]="F"+(c-111)},{}],3:[function(a,b){function c(a,b){function c(){4===k.readyState&&e()}function e(){var a=null,c=k.statusCode=k.status,d=null;if(k.response?d=k.body=k.response:"text"!==k.responseType&&k.responseType||(d=k.body=k.responseText||k.responseXML),1223===c&&(c=204),0===c||c>=400&&600>c){var e=("string"==typeof d?d:!1)||g[String(k.status).charAt(0)];a=new Error(e),a.statusCode=k.status}if(r)try{d=k.body=JSON.parse(d)}catch(f){}b(a,k,d)}function j(a){b(a,k)}"string"==typeof a&&(a={uri:a}),a=a||{},b=f(b);var k=a.xhr||null;!k&&a.cors?k=new i:k||(k=new h);var l,m=k.url=a.uri||a.url,n=k.method=a.method||"GET",o=a.body||a.data,p=k.headers=a.headers||{},q=!!a.sync,r=!1;if("json"in a&&(r=!0,p.Accept="application/json","GET"!==n&&"HEAD"!==n&&(p["Content-Type"]="application/json",o=JSON.stringify(a.json))),k.onreadystatechange=c,k.onload=e,k.onerror=j,k.onprogress=function(){},k.ontimeout=d,k.open(n,m,!q),a.cors&&(k.withCredentials=!0),q||(k.timeout="timeout"in a?a.timeout:5e3),k.setRequestHeader)for(l in p)p.hasOwnProperty(l)&&k.setRequestHeader(l,p[l]);return"responseType"in a&&(k.responseType=a.responseType),"beforeSend"in a&&"function"==typeof a.beforeSend&&a.beforeSend(k),k.send(o),k}function d(){}var e=a(1),f=a(2),g={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},h=e.XMLHttpRequest||d,i="withCredentials"in new h?e.XMLHttpRequest:e.XDomainRequest;b.exports=c},{1:4,2:5}],4:[function(a,b){b.exports="undefined"!=typeof window?window:"undefined"!=typeof global?global:{}},{}],5:[function(a,b){function c(a){var b=!1;return function(){return b?void 0:(b=!0,a.apply(this,arguments))}}b.exports=c,c.proto=c(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return c(this)},configurable:!0})})},{}],6:[function(a,b){b.exports={handleQuota:!0,QPS:2,forwarderAddress:"apiForwarder.html",filepickerViewAddress:"folderExplorer.do",channelMarker:"'E"}},{}],7:[function(a,b){var c=a(2),d=a(3),e=a(1);b.exports=function(b){var f=c(b),g=d(f,b),h=e(f,b),i={auth:f,storage:g,link:h};if(b.acceptForwarding){var j=a(4);j(b,i)}else if(window.XDomainRequest){var k=a(5);k(b,i)}return i}},{1:9,2:10,3:11,4:12,5:13}],8:[function(a,b){function c(a){var b;for(var d in a){if(e[d])return a[d];if("object"==typeof a[d]&&(b=c(a[d])))return b}}function d(a,b){var d;try{d=c(JSON.parse(a)),d||(d=a)}catch(e){d=a?a.replace(f,"$1"):"Unknown error"}return 404===b&&a.length>300&&(d="Not found"),d}var e={msg:1,message:1,errorMessage:1},f=/^\s*<h1>([^<]*)<\/h1>\s*$/gi;b.exports=function(a){var b,c;return a.response?(c=~~a.response.statusCode,b=a.error,b.statusCode=c,b.message=d(a.error.message,c),b.response=a.response,b.body=a.body):(b=a.error,b.statusCode=0),b}},{}],9:[function(a,b){function c(a){var b={path:null,type:"file",accessibility:"domain"};return j.start(!0).then(function(){if(a=k.extend(b,a),a.path=k.encodeNameSafe(a.path),!a.path)throw new Error("Path attribute missing or incorrect");return h.promiseRequest({method:"POST",url:h.getEndpoint()+l,json:a})}).then(function(a){return a.body})}function d(a){return h.promiseRequest({method:"DELETE",url:h.getEndpoint()+l+"/"+a}).then(function(a){return a.response.statusCode})}function e(a){return h.promiseRequest({method:"GET",url:h.getEndpoint()+l+"/"+a}).then(function(a){return a.body})}function f(a){return j.start(!0).then(function(){return a.path=a.path&&k.encodeNameSafe(a.path),h.promiseRequest({method:"get",url:h.getEndpoint()+l,params:a})}).then(function(a){return a.body})}function g(a){return f(a).then(function(a){return a.ids&&a.ids.length>0?e(a.ids[0]):null})}var h,i,j=a(1),k=a(2),l="/links";b.exports=function(a,b){return i=b,h=a,{createLink:c,removeLink:d,listLink:e,listLinks:f,findOne:g}}},{1:14,2:16}],10:[function(a,b){function c(a){this.options=a,this.options.token&&(this.token=this.options.token),this.userInfo=null,this.quota={startOfTheSecond:0,calls:0,retrying:0},this.queue=[],this.queueHandler=j.bindThis(this,e),this.getUserInfo=j.bindThis(this,this.getUserInfo)}function d(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function e(){if(this.queue.length){var a=f(this.quota,this.options.QPS);if(0===a){var b=this.queue.shift();b(),this.quota.calls++}this.quota.to=setTimeout(this.queueHandler,a)}}function f(a,b){var c=+new Date,d=c-a.startOfTheSecond;return a.retrying?(a.startOfTheSecond=c+a.retrying,a.retrying+1):d>1e3?(a.startOfTheSecond=c,a.calls=0,0):a.calls<b?0:1001-d}var g=/access_token=([^&]+)/,h=/\?error=access_denied/,i=a(1),j=a(3),k=a(2),l=a(4),m=a(5),n=a(6),o={};o._reloadForToken=function(){window.location.href=this.options.egnyteDomainURL+"/puboauth/token?client_id="+this.options.key+"&mobile="+~~this.options.mobile+"&redirect_uri="+window.location.href},o._checkTokenResponse=function(a,b,c,d){var e=d||window;if(this.token)a&&a();else{this.userInfo=null;var f=g.exec(e.location.hash);f?f.length>1&&(this.token=f[1],a&&a()):h.test(e.location.href)?b&&b():c&&c()}},o.requestTokenReload=function(a,b){this._checkTokenResponse(a,b,j.bindThis(this,this._reloadForToken))},o.requestTokenIframe=function(a,b,c,d){if(this.token)b();else{var e=this,f=window.location;d=d?f.protocol+"//"+f.host+d:f.href;var g=this.options.egnyteDomainURL+"/puboauth/token?client_id="+this.options.key+"&mobile="+~~this.options.mobile+"&redirect_uri="+d,h=k.createFrame(g,!0);h.onload=function(){try{var d=h.contentWindow.location,f={location:{hash:""+d.hash,href:""+d.href}};e._checkTokenResponse(function(){h.src="",a.removeChild(h),b()},function(){h.src="",a.removeChild(h),c()},null,f)}catch(g){}},a.appendChild(h)}},o._postTokenUp=function(){var a=this;if(!this.token&&window.name===this.options.channelMarker){var b={marker:this.options.channelMarker,sourceOrigin:this.options.egnyteDomainURL};this._checkTokenResponse(function(){l.sendMessage(window.opener,b,"token",a.token)},function(){l.sendMessage(window.opener,b,"denied","")})}},o.requestTokenPopup=function(a,b,c){var d=this;if(this.token)a();else{var e=this.options.egnyteDomainURL+"/puboauth/token?client_id="+this.options.key+"&mobile="+~~this.options.mobile+"&redirect_uri="+c,f=window.open(e);f.name=this.options.channelMarker;var g=l.createMessageHandler(null,this.options.channelMarker,function(c){h.destroy(),f.close(),"token"===c.action&&(d.token=c.data,a&&a()),"denied"===c.action&&b&&b()}),h=k.addListener(window,"message",g)}},o.authorizeXHR=function(a){a.setRequestHeader("Authorization","Bearer "+this.token)},o.getHeaders=function(){return{Authorization:"Bearer "+this.token}},o.getEndpoint=function(){return this.options.egnyteDomainURL+"/pubapi/v1"},o.isAuthorized=function(){return!!this.token},o.getToken=function(){return this.token},o.setToken=function(a){this.token=a},o.dropToken=function(){this.token=null},o.sendRequest=function(a,b){var c=this,e=j.extend({},a);return this.isAuthorized()?(a.params&&(a.url+="?"+d(a.params)),a.headers=a.headers||{},a.headers.Authorization="Bearer "+this.getToken(),n(a,function(a,d,f){try{f=JSON.parse(f)}catch(g){}if(d.getResponseHeader)var h=d.getResponseHeader("Retry-After"),i=d.getResponseHeader("X-Mashery-Error-Code");c.options.handleQuota&&403===d.statusCode&&h?("ERR_403_DEVELOPER_OVER_QPS"===i&&(console&&console.warn("develoer over QPS, retrying"),c.quota.retrying=1e3*~~h,setTimeout(function(){c.quota.retrying=0,c.sendRequest(e,b)},c.quota.retrying)),"ERR_403_DEVELOPER_OVER_RATE"===i&&(a.RATE=!0,b.call(this,a,d,f))):(c.options.onInvalidToken&&(401===d.statusCode||403===d.statusCode&&"ERR_403_DEVELOPER_INACTIVE"===i)&&(c.dropToken(),c.options.onInvalidToken()),b.call(this,a,d,f))})):void b.call(this,new Error("Not authorized"),{statusCode:0},null)},o.promiseRequest=function(a){var b=i.defer(),c=this,d=function(){try{c.sendRequest(a,function(a,c,d){a?b.reject(m({error:a,response:c,body:d})):b.resolve({response:c,body:d})})}catch(d){b.reject(m({error:d}))}};return this.options.handleQuota?(this.queue.push(d),clearTimeout(this.quota.to),this.queueHandler()):d(),b.promise},o.getUserInfo=function(){var a=this;return a.userInfo?i.start(!0).then(function(){return a.userInfo}):this.promiseRequest({method:"GET",url:this.getEndpoint()+"/userinfo"}).then(function(b){return a.userInfo=b.body,b.body})},c.prototype=o,b.exports=function(a){return new c(a)}},{1:14,2:15,3:16,4:17,5:8,6:3}],11:[function(a,b){function c(a){return p.start(!0).then(function(){return a=q.encodeNameSafe(a),n.promiseRequest({method:"GET",url:n.getEndpoint()+r+encodeURI(a)})}).then(function(a){return 200==a.response.statusCode?!0:!1},function(a){if(a.response&&404==a.response.statusCode)return!1;throw a})}function d(a){return p.start(!0).then(function(){return a=q.encodeNameSafe(a),n.promiseRequest({method:"GET",url:n.getEndpoint()+r+encodeURI(a)})}).then(function(a){return a.body})}function e(a,b){return p.start(!0).then(function(){a=q.encodeNameSafe(a);var c={method:"GET",url:n.getEndpoint()+s+encodeURI(a)};return b&&(c.responseType="arraybuffer"),n.promiseRequest(c)}).then(function(a){return a.response})}function f(a){return p.start(!0).then(function(){return a=q.encodeNameSafe(a),n.promiseRequest({method:"POST",url:n.getEndpoint()+r+encodeURI(a),json:{action:"add_folder"}})}).then(function(b){return 201==b.response.statusCode?{path:a}:void 0})}function g(a,b){return i(a,b,"move")}function h(a,b){return i(a,b,"copy")}function i(a,b,c){return p.start(!0).then(function(){if(!b)throw new Error("Cannot move to empty path");return a=q.encodeNameSafe(a),b=q.encodeNameSafe(b),n.promiseRequest({method:"POST",url:n.getEndpoint()+r+encodeURI(a),json:{action:c,destination:"/"+b}})}).then(function(c){return 200==c.response.statusCode?{oldPath:a,path:b}:void 0})}function j(a,b){return p.start(!0).then(function(){var c=b;return a=q.encodeNameSafe(a)||"",n.promiseRequest({method:"POST",url:n.getEndpoint()+s+encodeURI(a),body:c})}).then(function(b){return{id:b.response.getResponseHeader("etag"),path:a}})}function k(a,b){return p.start(!0).then(function(){a=q.encodeNameSafe(a)||"";var c={method:"DELETE",url:n.getEndpoint()+r+encodeURI(a)};return b&&(c.params={entry_id:b}),n.promiseRequest(c)}).then(function(a){return a.response.statusCode})}function l(a,b){return p.start(!0).then(function(){if(!b)throw new Error("Version ID (second argument) is missing");return k(a,b)})}function m(a){return k(a)}var n,o,p=a(1),q=a(2),r="/fs",s="/fs-content";b.exports=function(a,b){return o=b,n=a,{exists:c,get:d,download:e,createFolder:f,move:g,copy:h,rename:g,remove:m,storeFile:j,removeFileVersion:l}}},{1:14,2:16}],12:[function(a,b){function c(a,b){function c(a){if(a.action&&"call"===a.action){var c=JSON.parse(a.data);b[c.ns]&&b[c.ns][c.name]?(b.auth.setToken(c.token),b[c.ns][c.name].apply("whatever",c.args).then(function(a){e.sendMessage(window.parent,f,"result",JSON.stringify({status:!0,resolution:a,uid:c.uid}))},function(a){e.sendMessage(window.parent,f,"result",JSON.stringify({status:!1,resolution:a,uid:c.uid}))})):e.sendMessage(window.parent,f,"nomethod",JSON.stringify({uid:c.uid}))}}var f;f={marker:a.channelMarker,sourceOrigin:a.egnyteDomainURL},f.handler=e.createMessageHandler(null,f.marker,c),f._evListener=d.addListener(window,"message",f.handler)}var d=(a(2),a(1)),e=a(3);b.exports=c},{1:15,2:16,3:17}],13:[function(a,b){function c(a){var b=JSON.parse(a.data);a.action&&("result"===a.action&&(l[b.uid](b.status,b.resolution),l[b.uid]=null),"nomethod"===a.action&&(l[b.uid]=null))}function d(a,b,c,d,e,f){var g=~~(9999999*Math.random())+""+~~(9999999*Math.random());l[g]=f,k.sendMessage(a.iframe.contentWindow,a,"call",JSON.stringify({ns:b,name:c,args:e,token:d,uid:g}))}function e(a,b,c,e){return function(){var f=Array.prototype.slice.call(arguments,0),g=h.defer();return c.ready.promise.then(function(){d(c,a,b,e(),f,function(a,b){a?g.resolve(b):g.reject(b)})}),g.promise}}function f(a,b){var c=function(c,d){a[c][d]=e(c,d,b,function(){return a.auth.getToken()})};i.each(a,function(a,b){if("auth"!==b)for(var d in a)c(b,d)}),c("auth","getUserInfo");var d=a.destroy;return a.destroy=function(){return b._evListener.destroy(),b.iframe.parentNode.removeChild(b.iframe),d?d.apply(a,arguments):void 0},a}function g(a,b){var d,e;e={marker:a.channelMarker,sourceOrigin:a.egnyteDomainURL,ready:h.defer()},e.handler=k.createMessageHandler(e.sourceOrigin,e.marker,c),e._evListener=j.addListener(window,"message",e.handler),d=j.createFrame(a.egnyteDomainURL+"/"+a.forwarderAddress),d.style.display="none";var g=function(){setTimeout(function(){e.ready.resolve()},50)};d.addEventListener?d.addEventListener("load",g,!1):d.attachEvent&&d.attachEvent("onload",g);var i=document.body||document.getElementsByTagName("body")[0];return i.appendChild(d),e.iframe=d,f(b,e)}var h=a(1),i=a(3),j=a(2),k=a(4),l={};b.exports=g},{1:14,2:15,3:16,4:17}],14:[function(a,b){var c=a(1),d=function(a){return a.error=function(b){return a.then(0,b)},a};b.exports={defer:function(){var a=c(d);return{promise:a,resolve:function(b){a(!0,[b])},reject:function(b){a(!1,[b])}}},start:function(a){var b=c(d);return b(a),b}}},{1:1}],15:[function(a,b){function c(a,b,c){var e;return a.addEventListener?(e=c,a.addEventListener(b,c,!1)):(e=function(a){a=a||window.event,a.target||(a.target=a.srcElement);var b=c.call(this,a);return b===!1&&(a.cancelBubble=!0),b},a.attachEvent("on"+b,e)),{destroy:function(){d(a,b,e)}}}function d(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent(b,c)}var e=a(1);b.exports={addListener:c,onKeys:function(a,b,d){return c(a,"keyup",function(a){return a.preventDefault&&a.preventDefault(),d()&&b[e[a.keyCode]]&&b[e[a.keyCode]](),!1})},createFrame:function(a,b){var c=document.createElement("iframe");return b||c.setAttribute("scrolling","no"),c.style.width="100%",c.style.height="100%",c.style.minWidth="400px",c.style.minHeight="400px",c.style.border="1px solid #dbdbdb",c.src=a,c}}},{1:2}],16:[function(a,b){function c(a,b){if(a)if(a.length===+a.length)for(var c=0;c<a.length;c++)b.call(null,a[c],c,a);else for(var c in a)a.hasOwnProperty(c)&&b.call(null,a[c],c,a)}var d=/[":<>|?*+&#\\]/;b.exports={extend:function(a){var b,c;for(b=1;b<arguments.length;b++)if(arguments[b])for(c in arguments[b])arguments[b].hasOwnProperty(c)&&"undefined"!=typeof arguments[b][c]&&(a[c]=arguments[b][c]);return a},noop:function(){},bindThis:function(a,b){return function(){return b.apply(a,arguments)}},each:c,normalizeURL:function(a){return a.replace(/\/*$/,"")},encodeNameSafe:function(a){if(!a)throw new Error("No name given");if(d.test(a))throw new Error("Disallowed characters in path");return a=a.replace(/^\/\//,"/")}}},{}],17:[function(a,b){function c(a,b,c){return function(d){if(!a||e.normalizeURL(d.origin)===e.normalizeURL(a)){var f=d.data;if(f.substr(0,2)===b){try{f=JSON.parse(f.substring(2))}catch(g){}f&&c(f)}}}}function d(a,b,c,d){var e="*";if("string"!=typeof d||"string"!=typeof c)throw new TypeError("only string is acceptable as action and data");try{e=a.location.origin||a.location.protocol+"//"+a.location.hostname+(a.location.port?":"+a.location.port:"")}catch(f){}d=d.replace(/"/gm,'\\"').replace(/(\r\n|\n|\r)/gm,""),a.postMessage(b.marker+'{"action":"'+c+'","data":"'+d+'"}',e)}var e=a(1);b.exports={sendMessage:d,createMessageHandler:c}},{1:16}],18:[function(a){!function(){"use strict";function b(b,e){return d=c.extend(d,e),d.egnyteDomainURL=c.normalizeURL(b),{domain:d.egnyteDomainURL,API:a(2)(d)}}var c=a(3),d=a(1);window.Egnyte={init:b}}()},{1:6,2:7,3:16}]},{},[18]);