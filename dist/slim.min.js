// egnyte-sdk v0.1.1 (2014-06-13) 
// license:MIT 
// ztenerowicz@egnyte.com 
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){!function(a){function b(a){return"function"==typeof a}function c(a){return"object"==typeof a}function d(a){"undefined"!=typeof setImmediate?setImmediate(a):"undefined"!=typeof process&&process.nextTick?process.nextTick(a):setTimeout(a,0)}var e;a[0][a[1]]=function f(){var a,g=[],h=[],i=function(b,c){return null==a&&null!=b&&(a=b,g=c,h.length&&d(function(){for(var a=0;a<h.length;a++)h[a]()})),a};return i.then=function(i,j){var k=f(),l=function(){function d(a){var f,g=0;try{if(a&&(c(a)||b(a))&&b(f=a.then)){if(a===k)throw new TypeError;f.call(a,function(){g++||d.apply(e,arguments)},function(a){g++||k(!1,[a])})}else k(!0,arguments)}catch(h){g++||k(!1,[h])}}try{var f=a?i:j;b(f)?d(f.apply(e,g||[])):k(a,g)}catch(h){k(!1,[h])}};return null!=a?d(l):h.push(l),k},i.always=function(a){return i.then(a,a)},i.error=function(a){return i.then(0,a)},i}}("undefined"==typeof b?[window,"pinkySwear"]:[b,"exports"])},{}],2:[function(a,b){function c(a,b){function c(){4===k.readyState&&e()}function e(){var a=null,c=k.statusCode=k.status,d=k.body=k.response||k.responseText||k.responseXML;if(1223===c&&(c=204),0===c||c>=400&&600>c){var e;try{e=k.responseText}catch(f){}e=e||g[String(k.status).charAt(0)],a=new Error(e),a.statusCode=k.status}if(r)try{d=k.body=JSON.parse(d)}catch(f){}b(a,k,d)}function j(a){b(a,k)}"string"==typeof a&&(a={uri:a}),a=a||{},b=f(b);var k=a.xhr||null;!k&&a.cors?k=new i:k||(k=new h);var l,m=k.url=a.uri||a.url,n=k.method=a.method||"GET",o=a.body||a.data,p=k.headers=a.headers||{},q=!!a.sync,r=!1;if("json"in a&&(r=!0,"GET"!==n&&"HEAD"!==n&&(p["Content-Type"]="application/json",o=JSON.stringify(a.json))),k.onreadystatechange=c,k.onload=e,k.onerror=j,k.onprogress=function(){},k.ontimeout=d,k.open(n,m,!q),a.cors&&(k.withCredentials=!0),q||(k.timeout="timeout"in a?a.timeout:5e3),k.setRequestHeader)for(l in p)p.hasOwnProperty(l)&&k.setRequestHeader(l,p[l]);return"responseType"in a&&(k.responseType=a.responseType),k.send(o),k}function d(){}var e=a(1),f=a(2),g={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},h=e.XMLHttpRequest||d,i="withCredentials"in new h?e.XMLHttpRequest:e.XDomainRequest;b.exports=c},{1:3,2:4}],3:[function(a,b){b.exports="undefined"!=typeof window?window:"undefined"!=typeof global?global:{}},{}],4:[function(a,b){function c(a){var b=!1;return function(){return b?void 0:(b=!0,a.apply(this,arguments))}}b.exports=c,c.proto=c(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return c(this)},configurable:!0})})},{}],5:[function(a,b){b.exports={handleQuota:!0,QPS:2,filepickerViewAddress:"folderExplorer.do",channelMarker:"'E"}},{}],6:[function(a,b){var c=a(2),d=a(3),e=a(1);b.exports=function(a){var b=c(a),f=d(b,a),g=e(b,a);return{auth:b,storage:f,link:g}}},{1:7,2:8,3:9}],7:[function(a,b){function c(a){var b={path:null,type:"file",accessibility:"domain"};return i.start(!0).then(function(){if(a=j.extend(b,a),a.path=j.encodeNameSafe(a.path),!a.path)throw new Error("Path attribute missing or incorrect");return g.promiseRequest({method:"POST",url:g.getEndpoint()+k,json:a})}).then(function(a){return a.body})}function d(a){return g.promiseRequest({method:"DELETE",url:g.getEndpoint()+k+"/"+a}).then(function(a){return a.response.statusCode})}function e(a){return g.promiseRequest({method:"GET",url:g.getEndpoint()+k+"/"+a}).then(function(a){return a.body})}function f(a){return i.start(!0).then(function(){return a.path=a.path&&j.encodeNameSafe(a.path),g.promiseRequest({method:"get",url:g.getEndpoint()+k,params:a})}).then(function(a){return a.body})}var g,h,i=a(1),j=a(2),k="/links";b.exports=function(a,b){return h=b,g=a,{createLink:c,removeLink:d,listLink:e,listLinks:f}}},{1:10,2:11}],8:[function(a,b){function c(a){this.options=a,this.quota={startOfTheSecond:0,calls:0,retrying:0},this.queue=[],this.options.token&&(this.token=this.options.token),this.queueHandler=h.bindThis(this,e)}function d(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function e(){if(this.queue.length){var a=this.quotaWaitTime();if(0===a){var b=this.queue.shift();b(),this.quota.calls++}this.quota.to=setTimeout(this.queueHandler,a)}}var f=/access_token=([^&]+)/,g=a(1),h=a(2),i=a(3),j={};j.reloadForToken=function(){window.location.href=this.options.egnyteDomainURL+"/puboauth/token?client_id="+this.options.key+"&mobile="+~~this.options.mobile+"&redirect_uri="+window.location.href},j.checkTokenResponse=function(a,b){if(this.token)a&&a();else{var c=f.exec(window.location.hash);c?c.length>1&&(this.token=c[1],window.location.hash="",a&&a()):b&&b()}},j.requestToken=function(a){this.checkTokenResponse(a,h.bindThis(this,this.reloadForToken))},j.onTokenReady=function(a){this.checkTokenResponse(a,function(){})},j.requestTokenWindow=function(){},j.authorizeXHR=function(a){a.setRequestHeader("Authorization","Bearer "+this.token)},j.getHeaders=function(){return{Authorization:"Bearer "+this.token}},j.getEndpoint=function(){return this.options.egnyteDomainURL+"/pubapi/v1"},j.isAuthorized=function(){return!!this.token},j.getToken=function(){return this.token},j.setToken=function(a){this.token=a},j.dropToken=function(){this.token=null},j.sendRequest=function(a,b){var c=this,e=h.extend({},a);return this.isAuthorized()?(a.params&&(a.url+="?"+d(a.params)),a.headers=a.headers||{},a.headers.Authorization="Bearer "+this.getToken(),i(a,function(a,d,f){try{f=JSON.parse(f)}catch(g){}c.options.handleQuota&&403===d.statusCode&&d.getResponseHeader("Retry-After")?(console&&console.warn("develoer over QPS, retrying"),c.quota.retrying=1e3*~~d.getResponseHeader("Retry-After"),setTimeout(function(){c.quota.retrying=0,c.sendRequest(e,b)},c.quota.retrying)):b.call(this,a,d,f)})):void b.call(this,new Error("Not authorized"),{statusCode:0},null)},j.promiseRequest=function(a){var b=g.defer(),c=this,d=function(){try{c.sendRequest(a,function(a,c,d){a?b.reject({error:a,response:c,body:d}):b.resolve({response:c,body:d})})}catch(d){b.reject({error:d})}};return this.addToQueue(d),b.promise},j.addToQueue=function(a){this.options.handleQuota?(this.queue.push(a),clearTimeout(this.quota.to),this.queueHandler()):a()},j.quotaWaitTime=function(){var a=+new Date,b=a-this.quota.startOfTheSecond;return this.quota.retrying?(this.quota.startOfTheSecond=a+this.quota.retrying,this.quota.retrying+1):b>1e3?(this.quota.startOfTheSecond=a,this.quota.calls=0,0):this.quota.calls<this.options.QPS?0:1001-b},c.prototype=j,b.exports=function(a){return new c(a)}},{1:10,2:11,3:2}],9:[function(a,b){function c(a){return n.start(!0).then(function(){return a=o.encodeNameSafe(a),l.promiseRequest({method:"GET",url:l.getEndpoint()+p+encodeURI(a)})}).then(function(a){return 200==a.response.statusCode?!0:!1},function(a){if(a.response&&404==a.response.statusCode)return!1;throw a.error})}function d(a){return n.start(!0).then(function(){return a=o.encodeNameSafe(a),l.promiseRequest({method:"GET",url:l.getEndpoint()+p+encodeURI(a)})}).then(function(a){return a.body})}function e(a,b){return n.start(!0).then(function(){a=o.encodeNameSafe(a);var c={method:"GET",url:l.getEndpoint()+q+encodeURI(a)};return b&&(c.responseType="arraybuffer"),l.promiseRequest(c)}).then(function(a){return a.response})}function f(a){return n.start(!0).then(function(){return a=o.encodeNameSafe(a),l.promiseRequest({method:"POST",url:l.getEndpoint()+p+encodeURI(a),json:{action:"add_folder"}})}).then(function(b){return 201==b.response.statusCode?{path:a}:void 0})}function g(a,b){return n.start(!0).then(function(){if(!b)throw new Error("Cannot move to empty path");return a=o.encodeNameSafe(a),b=o.encodeNameSafe(b),l.promiseRequest({method:"POST",url:l.getEndpoint()+p+encodeURI(a),json:{action:"move",destination:"/"+b}})}).then(function(c){return 200==c.response.statusCode?{oldPath:a,path:b}:void 0})}function h(a,b){return n.start(!0).then(function(){if(!window.FormData)throw new Error("Unsupported browser");var c=b,d=new window.FormData;return d.append("file",c),a=o.encodeNameSafe(a)||"",l.promiseRequest({method:"POST",url:l.getEndpoint()+q+encodeURI(a),body:d})}).then(function(b){if(200===b.response.statusCode||201===b.response.statusCode)return{id:b.response.getResponseHeader("etag"),path:a};throw new Error(b.response.statusCode)})}function i(a,b){return n.start(!0).then(function(){a=o.encodeNameSafe(a)||"";var c={method:"DELETE",url:l.getEndpoint()+p+encodeURI(a)};return b&&(c.params={entry_id:b}),l.promiseRequest(c)}).then(function(a){return a.response.statusCode})}function j(a,b){return n.start(!0).then(function(){if(!b)throw new Error("Version ID (second argument) is missing");return i(a,b)})}function k(a){return i(a)}var l,m,n=a(1),o=a(2),p="/fs",q="/fs-content";b.exports=function(a,b){return m=b,l=a,{exists:c,get:d,download:e,createFolder:f,move:g,rename:g,remove:k,storeFile:h,removeFileVersion:j}}},{1:10,2:11}],10:[function(a,b){var c=a(1);b.exports={defer:function(){var a=c();return{promise:a,resolve:function(b){a(!0,[b])},reject:function(b){a(!1,[b])}}},start:function(a){var b=c();return b(a),b}}},{1:1}],11:[function(a,b){function c(a,b){if(a)if(a.length===+a.length)for(var c=0;c<a.length;c++)b.call(null,a[c],c,a);else for(var c in a)a.hasOwnProperty(c)&&b.call(null,a[c],c,a)}b.exports={extend:function(a){var b,c;for(b=1;b<arguments.length;b++)if(arguments[b])for(c in arguments[b])arguments[b].hasOwnProperty(c)&&"undefined"!=typeof arguments[b][c]&&(a[c]=arguments[b][c]);return a},noop:function(){},bindThis:function(a,b){return function(){return b.apply(a,arguments)}},each:c,normalizeURL:function(a){return a.replace(/\/*$/,"")},encodeNameSafe:function(a){if(!a)throw new Error("No name given");var b=[];return c(a.split("/"),function(a){b.push(a.replace(/[?*&#%<>]*/gi,""))}),b=b.join("/").replace(/^\/\//,"/")}}},{}],12:[function(a){!function(){"use strict";function b(b,e){return d=c.extend(d,e),d.egnyteDomainURL=c.normalizeURL(b),{domain:d.egnyteDomainURL,API:a(2)(d)}}var c=a(3),d=a(1);window.Egnyte={init:b}}()},{1:5,2:6,3:11}]},{},[12]);